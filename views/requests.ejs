<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Requests — Beyond The Interface</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/css/index.css" />
    <style>
      .requests-page {
        min-height: 100vh;
        padding: 60px 20px;
      }
      .requests-container {
        max-width: 1100px;
        margin: 0 auto;
      }
      .back-link {
        display: inline-block;
        margin-bottom: 20px;
        color: var(--accent);
        text-decoration: none;
        font-weight: 600;
      }
      .back-link:hover {
        text-decoration: underline;
      }
      .requests-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 20px;
        margin-top: 30px;
      }
      .request-card {
        background: var(--surface);
        border-radius: var(--radius);
        border: 1px solid var(--border);
        box-shadow: var(--shadow);
        padding: 20px;
      }
      .request-card h4 {
        margin: 0 0 8px;
        color: var(--text);
      }
      .request-card .email {
        color: var(--accent);
        text-decoration: none;
        font-weight: 600;
        margin-bottom: 12px;
        display: block;
      }
      .request-card .message {
        color: var(--text);
        margin-bottom: 12px;
        line-height: 1.6;
      }
      .request-card .date {
        color: var(--muted);
        font-size: 12px;
      }
      .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: var(--muted);
      }
      .empty-state p {
        margin: 10px 0;
      }
    </style>
  </head>
  <body>
    <!-- Decorative floating shapes -->
    <div class="bg-shape shape-1"></div>
    <div class="bg-shape shape-2"></div>
    <div class="bg-shape shape-3"></div>

    <!-- Navbar -->
    <header class="header">
      <nav class="nav glass">
        <a href="/" class="logo">Dhiraj<span class="accent">.</span></a>
        <button class="nav-toggle" aria-label="Toggle navigation">
          <span class="bar"></span>
          <span class="bar"></span>
          <span class="bar"></span>
        </button>
        <ul class="nav-links">
          <li><a href="/">Home</a></li>
          <li><a href="/#about">About</a></li>
          <li><a href="/#skills">Skills</a></li>
          <li><a href="/#experience">Experience</a></li>
          <li><a href="/#projects">Projects</a></li>
          <li><a href="/#education">Education</a></li>
          <li><a href="/#certifications">Certifications</a></li>
          <li><a href="/#services">Services</a></li>
          <li><a href="/requests">Requests</a></li>
          <li>
            <a href="/contact" class="btn btn-pill btn-primary small"
              >Contact</a
            >
          </li>
        </ul>
      </nav>
    </header>

    <main>
      <section class="requests-page">
        <div class="requests-container">
          <a href="/" class="back-link">← Back to Home</a>
          <div class="section-head">
            <h3>Contact Requests</h3>
            <p class="muted">Messages received from visitors.</p>
          </div>

          <div id="requests-content">
            <div class="empty-state">
              <p>Loading requests...</p>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <p class="muted">
          © <span id="year"></span> Dhiraj Kumar. Crafted with care.
        </p>
      </div>
    </footer>

    <script src="/js/index.js"></script>
    <script>
      document.getElementById("year").textContent = new Date().getFullYear();

      async function loadRequests() {
        try {
          const res = await fetch("/api/messages");
          const data = await res.json();
          const messages = data.messages || [];
          const container = document.getElementById("requests-content");

          if (messages.length === 0) {
            container.innerHTML =
              '<div class="empty-state"><p>No requests yet. Check back soon!</p></div>';
            return;
          }

          let html = '<div class="requests-grid">';
          messages.forEach((msg) => {
            const date = new Date(msg.createdAt).toLocaleDateString("en-US", {
              year: "numeric",
              month: "short",
              day: "numeric",
              hour: "2-digit",
              minute: "2-digit",
            });
            html += `
            <div class="request-card">
              <h4>${msg.name}</h4>
              <a href="mailto:${msg.email}" class="email">${msg.email}</a>
              <p class="message">${msg.message}</p>
              <p class="date">${date}</p>
            </div>
          `;
          });
          html += "</div>";
          container.innerHTML = html;
        } catch (err) {
          console.error("Error loading requests:", err);
          document.getElementById("requests-content").innerHTML =
            '<div class="empty-state"><p>Error loading requests.</p></div>';
        }
      }

      loadRequests();
    </script>
  </body>
</html>
